/*
 *  arch/arm/mach-sun6i/clock/ccmu/pll_cfg_tbl.c
 *
 * Copyright 2012 (c) Allwinner.
 * kevin.z.m (kevin@allwinnertech.com)
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */
#include "ccm_i.h"

struct pll_freq_cfg_tbl{
    __u8    FactorN;
    __u8    FactorK;
    __u8    FactorM;
    __u8    FactorP;
    __u32   Pll;
};

/* core pll parameter table */
#if 0
static struct pll_freq_cfg_tbl    Pll1Tbl[] = {

    { 17,    0,    0,    0,    408000000 },   /* freq = (6M * 68 ), index = 68  */
    { 25,    0,    0,    0,    600000000 },   /* freq = (6M * 100), index = 100 */
    { 20,    1,    0,    0,    960000000 },   /* freq = (6M * 160), index = 160 */
    { 25,    1,    0,    0,    1200000000},   /* freq = (6M * 200), index = 200 */
};
#endif
int ccm_get_pll1_para(__ccmu_pll1_reg0000_t *factor, __u64 rate)
{
    if(!factor)
    {
        return -1;
    }

    #if(0)
    factor->FactorN = Pll1Tbl[1].FactorN;
    factor->FactorK = Pll1Tbl[1].FactorK;
    factor->FactorM = Pll1Tbl[1].FactorM;
    #endif

    /* software config not valid, controlled by hw */
    return -1;
}


/* normal pll(3/4/7/8/9/10) parameter table, frequency = 24*N/M */
static struct pll_freq_cfg_tbl    PllxTbl[] = {
    {1 , 0, 15,0, 3000000  }, /* freq = (3M * 0  ), index = 0  */
    {1 , 0, 15,0, 3000000  }, /* freq = (3M * 1  ), index = 1  */
    {1, 0, 7, 0, 6000000  }, /* freq = (3M * 2  ), index = 2  */
    {2, 0, 7, 0, 9000000  }, /* freq = (3M * 3  ), index = 3  */
    {1, 0, 3, 0, 12000000 }, /* freq = (3M * 4  ), index = 4  */
    {4, 0, 7, 0, 15000000 }, /* freq = (3M * 5  ), index = 5  */
    {2, 0, 3, 0, 18000000 }, /* freq = (3M * 6  ), index = 6  */
    {6, 0, 7, 0, 21000000 }, /* freq = (3M * 7  ), index = 7  */
    {1, 0, 1, 0, 24000000 }, /* freq = (3M * 8  ), index = 8  */
    {8, 0, 7, 0, 27000000 }, /* freq = (3M * 9  ), index = 9  */
    {4, 0, 3, 0, 30000000 }, /* freq = (3M * 10 ), index = 10 */
    {10, 0, 7, 0, 33000000 }, /* freq = (3M * 11 ), index = 11 */
    {2, 0, 1, 0, 36000000 }, /* freq = (3M * 12 ), index = 12 */
    {12, 0, 7, 0, 39000000 }, /* freq = (3M * 13 ), index = 13 */
    {6, 0, 3, 0, 42000000 }, /* freq = (3M * 14 ), index = 14 */
    {14, 0, 7, 0, 45000000 }, /* freq = (3M * 15 ), index = 15 */
    {1, 0, 0, 0, 48000000 }, /* freq = (3M * 16 ), index = 16 */
    {16, 0, 7, 0, 51000000 }, /* freq = (3M * 17 ), index = 17 */
    {8, 0, 3, 0, 54000000 }, /* freq = (3M * 18 ), index = 18 */
    {18, 0, 7, 0, 57000000 }, /* freq = (3M * 19 ), index = 19 */
    {4, 0, 1, 0, 60000000 }, /* freq = (3M * 20 ), index = 20 */
    {20, 0, 7, 0, 63000000 }, /* freq = (3M * 21 ), index = 21 */
    {10, 0, 3, 0, 66000000 }, /* freq = (3M * 22 ), index = 22 */
    {22, 0, 7, 0, 69000000 }, /* freq = (3M * 23 ), index = 23 */
    {2, 0, 0, 0, 72000000 }, /* freq = (3M * 24 ), index = 24 */
    {24, 0, 7, 0, 75000000 }, /* freq = (3M * 25 ), index = 25 */
    {12, 0, 3, 0, 78000000 }, /* freq = (3M * 26 ), index = 26 */
    {12, 0, 3, 0, 78000000 }, /* freq = (3M * 27 ), index = 27 */
    {6, 0, 1, 0, 84000000 }, /* freq = (3M * 28 ), index = 28 */
    {14, 0, 3, 0, 90000000 }, /* freq = (3M * 29 ), index = 29 */
    {14, 0, 3, 0, 90000000 }, /* freq = (3M * 30 ), index = 30 */
    {14, 0, 3, 0, 90000000 }, /* freq = (3M * 31 ), index = 31 */
    {3, 0, 0, 0, 96000000 }, /* freq = (3M * 32 ), index = 32 */
    {3, 0, 0, 0, 96000000 }, /* freq = (3M * 33 ), index = 33 */
    {16, 0, 3, 0, 102000000}, /* freq = (3M * 34 ), index = 34 */
    {16, 0, 3, 0, 102000000}, /* freq = (3M * 35 ), index = 35 */
    {8, 0, 1, 0, 108000000}, /* freq = (3M * 36 ), index = 36 */
    {8, 0, 1, 0, 108000000}, /* freq = (3M * 37 ), index = 37 */
    {18, 0, 3, 0, 114000000}, /* freq = (3M * 38 ), index = 38 */
    {4, 0, 0, 0, 120000000}, /* freq = (3M * 39 ), index = 39 */
    {4, 0, 0, 0, 120000000}, /* freq = (3M * 40 ), index = 40 */
    {4, 0, 0, 0, 120000000}, /* freq = (3M * 41 ), index = 41 */
    {20, 0, 3, 0, 126000000}, /* freq = (3M * 42 ), index = 42 */
    {20, 0, 3, 0, 126000000}, /* freq = (3M * 43 ), index = 43 */
    {10, 0, 1, 0, 132000000}, /* freq = (3M * 44 ), index = 44 */
    {10, 0, 1, 0, 132000000}, /* freq = (3M * 45 ), index = 45 */
    {22, 0, 3, 0, 138000000}, /* freq = (3M * 46 ), index = 46 */
    {22, 0, 3, 0, 138000000}, /* freq = (3M * 47 ), index = 47 */
    {5, 0, 0, 0, 144000000}, /* freq = (3M * 48 ), index = 48 */
    {5, 0, 0, 0, 144000000}, /* freq = (3M * 49 ), index = 49 */
    {24, 0, 3, 0, 150000000}, /* freq = (3M * 50 ), index = 50 */
    {24, 0, 3, 0, 150000000}, /* freq = (3M * 51 ), index = 51 */
    {12, 0, 1, 0, 156000000}, /* freq = (3M * 52 ), index = 52 */
    {12, 0, 1, 0, 156000000}, /* freq = (3M * 53 ), index = 53 */
    {12, 0, 1, 0, 156000000}, /* freq = (3M * 54 ), index = 54 */
    {6, 0, 0, 0, 168000000}, /* freq = (3M * 55 ), index = 55 */
    {6, 0, 0, 0, 168000000}, /* freq = (3M * 56 ), index = 56 */
    {6, 0, 0, 0, 168000000}, /* freq = (3M * 57 ), index = 57 */
    {6, 0, 0, 0, 168000000}, /* freq = (3M * 58 ), index = 58 */
    {14, 0, 1, 0, 180000000}, /* freq = (3M * 59 ), index = 59 */
    {14, 0, 1, 0, 180000000}, /* freq = (3M * 60 ), index = 60 */
    {14, 0, 1, 0, 180000000}, /* freq = (3M * 61 ), index = 61 */
    {14, 0, 1, 0, 180000000}, /* freq = (3M * 62 ), index = 62 */
    {7, 0, 0, 0, 192000000}, /* freq = (3M * 63 ), index = 63 */
    {7, 0, 0, 0, 192000000}, /* freq = (3M * 64 ), index = 64 */
    {7, 0, 0, 0, 192000000}, /* freq = (3M * 65 ), index = 65 */
    {24, 0, 2, 0, 200000000}, /* freq = (3M * 66 ), index = 66 */
    {24, 0, 2, 0, 200000000}, /* freq = (3M * 67 ), index = 67 */
    {16, 0, 1, 0, 204000000}, /* freq = (3M * 68 ), index = 68 */
    {16, 0, 1, 0, 204000000}, /* freq = (3M * 69 ), index = 69 */
    {16, 0, 1, 0, 204000000}, /* freq = (3M * 70 ), index = 70 */
    {8, 0, 0, 0, 216000000}, /* freq = (3M * 71 ), index = 71 */
    {8, 0, 0, 0, 216000000}, /* freq = (3M * 72 ), index = 72 */
    {8, 0, 0, 0, 216000000}, /* freq = (3M * 73 ), index = 73 */
    {8, 0, 0, 0, 216000000}, /* freq = (3M * 74 ), index = 74 */
    {18, 0, 1, 0, 228000000}, /* freq = (3M * 75 ), index = 75 */
    {18, 0, 1, 0, 228000000}, /* freq = (3M * 76 ), index = 76 */
    {18, 0, 1, 0, 228000000}, /* freq = (3M * 77 ), index = 77 */
    {18, 0, 1, 0, 228000000}, /* freq = (3M * 78 ), index = 78 */
    {9, 0, 0, 0, 240000000}, /* freq = (3M * 79 ), index = 79 */
    {9, 0, 0, 0, 240000000}, /* freq = (3M * 80 ), index = 80 */
    {9, 0, 0, 0, 240000000}, /* freq = (3M * 81 ), index = 81 */
    {9, 0, 0, 0, 240000000}, /* freq = (3M * 82 ), index = 82 */
    {20, 0, 1, 0, 252000000}, /* freq = (3M * 83 ), index = 83 */
    {20, 0, 1, 0, 252000000}, /* freq = (3M * 84 ), index = 84 */
    {20, 0, 1, 0, 252000000}, /* freq = (3M * 85 ), index = 85 */
    {20, 0, 1, 0, 252000000}, /* freq = (3M * 86 ), index = 86 */
    {10, 0, 0, 0, 264000000}, /* freq = (3M * 87 ), index = 87 */
    {10, 0, 0, 0, 264000000}, /* freq = (3M * 88 ), index = 88 */
    {22, 0, 1, 0, 276000000}, /* freq = (3M * 89 ), index = 89 */
    {22, 0, 1, 0, 276000000}, /* freq = (3M * 90 ), index = 90 */
    {22, 0, 1, 0, 276000000}, /* freq = (3M * 91 ), index = 91 */
    {22, 0, 1, 0, 276000000}, /* freq = (3M * 92 ), index = 92 */
    {11, 0, 0, 0, 288000000}, /* freq = (3M * 93 ), index = 93 */
    {11, 0, 0, 0, 288000000}, /* freq = (3M * 94 ), index = 94 */
    {11, 0, 0, 0, 288000000}, /* freq = (3M * 95 ), index = 95 */
    {11, 0, 0, 0, 288000000}, /* freq = (3M * 96 ), index = 96 */
    {11, 0, 0, 0, 288000000}, /* freq = (3M * 97 ), index = 97 */
    {11, 0, 0, 0, 288000000}, /* freq = (3M * 98 ), index = 98 */
    {24, 0, 1, 0, 300000000}, /* freq = (3M * 99 ), index = 99 */
    {24, 0, 1, 0, 300000000}, /* freq = (3M * 100), index = 100*/
    {24, 0, 1, 0, 300000000}, /* freq = (3M * 101), index = 101*/
    {24, 0, 1, 0, 300000000}, /* freq = (3M * 102), index = 102*/
    {12, 0, 0, 0, 312000000}, /* freq = (3M * 103), index = 103*/
    {12, 0, 0, 0, 312000000}, /* freq = (3M * 104), index = 104*/
    {12, 0, 0, 0, 312000000}, /* freq = (3M * 105), index = 105*/
    {12, 0, 0, 0, 312000000}, /* freq = (3M * 106), index = 106*/
    {12, 0, 0, 0, 312000000}, /* freq = (3M * 107), index = 107*/
    {12, 0, 0, 0, 312000000}, /* freq = (3M * 108), index = 108*/
    {12, 0, 0, 0, 312000000}, /* freq = (3M * 109), index = 109*/
    {13, 0, 0, 0, 336000000}, /* freq = (3M * 110), index = 110*/
    {13, 0, 0, 0, 336000000}, /* freq = (3M * 111), index = 111*/
    {13, 0, 0, 0, 336000000}, /* freq = (3M * 112), index = 112*/
    {13, 0, 0, 0, 336000000}, /* freq = (3M * 113), index = 113*/
    {13, 0, 0, 0, 336000000}, /* freq = (3M * 114), index = 114*/
    {13, 0, 0, 0, 336000000}, /* freq = (3M * 115), index = 115*/
    {13, 0, 0, 0, 336000000}, /* freq = (3M * 116), index = 116*/
    {13, 0, 0, 0, 336000000}, /* freq = (3M * 117), index = 117*/
    {14, 0, 0, 0, 360000000}, /* freq = (3M * 118), index = 118*/
    {14, 0, 0, 0, 360000000}, /* freq = (3M * 119), index = 119*/
    {14, 0, 0, 0, 360000000}, /* freq = (3M * 120), index = 120*/
    {14, 0, 0, 0, 360000000}, /* freq = (3M * 121), index = 121*/
    {14, 0, 0, 0, 360000000}, /* freq = (3M * 122), index = 122*/
    {14, 0, 0, 0, 360000000}, /* freq = (3M * 123), index = 123*/
    {14, 0, 0, 0, 360000000}, /* freq = (3M * 124), index = 124*/
    {14, 0, 0, 0, 360000000}, /* freq = (3M * 125), index = 125*/
    {15, 0, 0, 0, 384000000}, /* freq = (3M * 126), index = 126*/
    {15, 0, 0, 0, 384000000}, /* freq = (3M * 127), index = 127*/
    {15, 0, 0, 0, 384000000}, /* freq = (3M * 128), index = 128*/
    {15, 0, 0, 0, 384000000}, /* freq = (3M * 129), index = 129*/
    {15, 0, 0, 0, 384000000}, /* freq = (3M * 130), index = 130*/
    {15, 0, 0, 0, 384000000}, /* freq = (3M * 131), index = 131*/
    {15, 0, 0, 0, 384000000}, /* freq = (3M * 132), index = 132*/
    {16, 0, 0, 0, 408000000}, /* freq = (3M * 133), index = 133*/
    {16, 0, 0, 0, 408000000}, /* freq = (3M * 134), index = 134*/
    {16, 0, 0, 0, 408000000}, /* freq = (3M * 135), index = 135*/
    {16, 0, 0, 0, 408000000}, /* freq = (3M * 136), index = 136*/
    {16, 0, 0, 0, 408000000}, /* freq = (3M * 137), index = 137*/
    {16, 0, 0, 0, 408000000}, /* freq = (3M * 138), index = 138*/
    {16, 0, 0, 0, 408000000}, /* freq = (3M * 139), index = 139*/
    {16, 0, 0, 0, 408000000}, /* freq = (3M * 140), index = 140*/
    {16, 0, 0, 0, 408000000}, /* freq = (3M * 141), index = 141*/
    {17, 0, 0, 0, 432000000}, /* freq = (3M * 142), index = 142*/
    {17, 0, 0, 0, 432000000}, /* freq = (3M * 143), index = 143*/
    {17, 0, 0, 0, 432000000}, /* freq = (3M * 144), index = 144*/
    {17, 0, 0, 0, 432000000}, /* freq = (3M * 145), index = 145*/
    {17, 0, 0, 0, 432000000}, /* freq = (3M * 146), index = 146*/
    {17, 0, 0, 0, 432000000}, /* freq = (3M * 147), index = 147*/
    {17, 0, 0, 0, 432000000}, /* freq = (3M * 148), index = 148*/
    {17, 0, 0, 0, 432000000}, /* freq = (3M * 149), index = 149*/
    {18, 0, 0, 0, 456000000}, /* freq = (3M * 150), index = 150*/
    {18, 0, 0, 0, 456000000}, /* freq = (3M * 151), index = 151*/
    {18, 0, 0, 0, 456000000}, /* freq = (3M * 152), index = 152*/
    {18, 0, 0, 0, 456000000}, /* freq = (3M * 153), index = 153*/
    {18, 0, 0, 0, 456000000}, /* freq = (3M * 154), index = 154*/
    {18, 0, 0, 0, 456000000}, /* freq = (3M * 155), index = 155*/
    {18, 0, 0, 0, 456000000}, /* freq = (3M * 156), index = 156*/
    {19, 0, 0, 0, 480000000}, /* freq = (3M * 157), index = 157*/
    {19, 0, 0, 0, 480000000}, /* freq = (3M * 158), index = 158*/
    {19, 0, 0, 0, 480000000}, /* freq = (3M * 159), index = 159*/
    {19, 0, 0, 0, 480000000}, /* freq = (3M * 160), index = 160*/
    {19, 0, 0, 0, 480000000}, /* freq = (3M * 161), index = 161*/
    {19, 0, 0, 0, 480000000}, /* freq = (3M * 162), index = 162*/
    {19, 0, 0, 0, 480000000}, /* freq = (3M * 163), index = 163*/
    {20, 0, 0, 0, 504000000}, /* freq = (3M * 164), index = 164*/
    {20, 0, 0, 0, 504000000}, /* freq = (3M * 165), index = 165*/
    {20, 0, 0, 0, 504000000}, /* freq = (3M * 166), index = 166*/
    {20, 0, 0, 0, 504000000}, /* freq = (3M * 167), index = 167*/
    {20, 0, 0, 0, 504000000}, /* freq = (3M * 168), index = 168*/
    {20, 0, 0, 0, 504000000}, /* freq = (3M * 169), index = 169*/
    {20, 0, 0, 0, 504000000}, /* freq = (3M * 170), index = 170*/
    {20, 0, 0, 0, 504000000}, /* freq = (3M * 171), index = 171*/
    {20, 0, 0, 0, 504000000}, /* freq = (3M * 172), index = 172*/
    {20, 0, 0, 0, 504000000}, /* freq = (3M * 173), index = 173*/
    {21, 0, 0, 0, 528000000}, /* freq = (3M * 174), index = 174*/
    {21, 0, 0, 0, 528000000}, /* freq = (3M * 175), index = 175*/
    {21, 0, 0, 0, 528000000}, /* freq = (3M * 176), index = 176*/
    {21, 0, 0, 0, 528000000}, /* freq = (3M * 177), index = 177*/
    {21, 0, 0, 0, 528000000}, /* freq = (3M * 178), index = 178*/
    {21, 0, 0, 0, 528000000}, /* freq = (3M * 179), index = 179*/
    {22, 0, 0, 0, 552000000}, /* freq = (3M * 180), index = 180*/
    {22, 0, 0, 0, 552000000}, /* freq = (3M * 181), index = 181*/
    {22, 0, 0, 0, 552000000}, /* freq = (3M * 182), index = 182*/
    {22, 0, 0, 0, 552000000}, /* freq = (3M * 183), index = 183*/
    {22, 0, 0, 0, 552000000}, /* freq = (3M * 184), index = 184*/
    {22, 0, 0, 0, 552000000}, /* freq = (3M * 185), index = 185*/
    {22, 0, 0, 0, 552000000}, /* freq = (3M * 186), index = 186*/
    {22, 0, 0, 0, 552000000}, /* freq = (3M * 187), index = 187*/
    {22, 0, 0, 0, 552000000}, /* freq = (3M * 188), index = 188*/
    {22, 0, 0, 0, 552000000}, /* freq = (3M * 189), index = 189*/
    {23, 0, 0, 0, 576000000}, /* freq = (3M * 190), index = 190*/
    {23, 0, 0, 0, 576000000}, /* freq = (3M * 191), index = 191*/
    {23, 0, 0, 0, 576000000}, /* freq = (3M * 192), index = 192*/
    {23, 0, 0, 0, 576000000}, /* freq = (3M * 193), index = 193*/
    {23, 0, 0, 0, 576000000}, /* freq = (3M * 194), index = 194*/
    {23, 0, 0, 0, 576000000}, /* freq = (3M * 195), index = 195*/
    {23, 0, 0, 0, 576000000}, /* freq = (3M * 196), index = 196*/
    {24, 0, 0, 0, 600000000}, /* freq = (3M * 197), index = 197*/
    {24, 0, 0, 0, 600000000}, /* freq = (3M * 198), index = 198*/
    {24, 0, 0, 0, 600000000}, /* freq = (3M * 199), index = 199*/
    {24, 0, 0, 0, 600000000}, /* freq = (3M * 200), index = 200*/
};
int ccm_get_pllx_para(__ccmu_media_pll_t *factor, __u64 rate)
{

    int     index;

    if(!factor || rate > 600000000)
    {
        /* parameter is invalid */
        return -1;
    }

    /* find the clock configuration */
    index = 600000000 / 3000000;
    factor->FactorN = PllxTbl[index].FactorN;
    factor->FactorM = PllxTbl[index].FactorM;
    return 0;
}
